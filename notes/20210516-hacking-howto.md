# Hacking 编程之道

翻译时间： 2021.05.16
原文链接： http://www.catb.org/esr/faqs/hacking-howto.html

## 译注

如何阅读源码？ 如何参与开源项目？ 如何提升自己编程能力？ ESR 这篇文章给了我们很好的指导。

## 作者

Eric S. Raymond

## 什么是 Hacking？

我们这里谈论的“Hacking”，是开源环境下的探索性编程。如果你认为“Hacking”与计算机犯罪、破坏安全有任何联系，那么便可移步他处，这里并无你想要的东西。

Hacking 主要指的是编程风格，如果依照本文建议，你将获得普适的编程技能。不过，这种方法，可能比较适合那些拥有中等以上编程天赋和思维灵活之人，而非所有人。如果掌握本文Hacking编程方法，比较容易成为通才，而非特定语言和技术领域的专才。

Hacking与软件工程里中成熟的方法论不同，且无正式的工具要求。Hacking有明显区别于其它编程风格的特点：

1. Hacking是基于开源代码的。现在，个人层面的Hacking即是社区层面的“开源开发”。一个以Hacking风格进行开发的程序员，乐意通过给他人代码进行代码评审(peer review)，来增加自身的能力。

2. Hacking是轻量级和探索性的。Hacking没有呆板的流程和精细的规格要求；相反，Hacking更倾向于边尝试边解决的快节奏。

3. Hacking特别看重模块化和重用性。在Hacking的风格里，要尽力避免写一次性代码，而是写一些通用工具和功能库。这样，只要你忽略掉一些参数，或提供一个上下文，就可以定制你需要的程序。

4. Hacking更愿意推倒重构，而非修修补补。Hacking风格的一个基本要素，就是无论前期花了多长时间，都要敢于无情地报废那些已臃肿不堪的代码。

Hacking的编程风格，已经和Unix操作系统编程传统密不可分。


## Hacking 编程

学习作曲有三个阶段。首先，你需要学会基本的乐器技能 —— 指法，以及如何演奏音阶。接着，你要训练你的耳朵能够理解音乐构型(pattern)。最后，你还得学会如何将这些构型(pattern)融会成自己的创作中。学习Hacking的过程很类似。

学习指法的阶段在Hacking中就是掌握编程语言以及编辑器、解释器、编译器等工具的使用。（如果你不太明白提到的这些概念，去看看这篇文章吧：The Unix and Internet Fundamentals HOWTO。）这里，我们不具体谈这些技术，因为它们取决于你使用哪一种语言。网上会有这些教程；试试搜索引擎吧。

演奏音阶的阶段对应于个人写些小程序。不幸的是，演奏音阶（1）并不能教会你音乐，而且（2）通常这一过程是十分枯燥的。同样，写些小程序（1）也不能教会你Hacking，而且（2）很可能会打击你劲头，这些程序恰好解决了你关心的问题。

大多编程教程/指导只是涉及到“演奏音阶”阶段，便停止深入了。这样教出的程序员不懂互相协作，对设计和架构毫无感觉，他们就像学习音乐而没有耳朵一样。

## 渐进式 Hacking 编程套路

有一种不错的学习方法。我管它叫做渐进式Hacking编程套路。

1. 首先，挑选一个你感兴趣的程序。最理想的情况是，它是你经常使用的一个程序，并且对它你有所心得。次一点的话，那就挑个你虽不常用但你认为很有趣的程序。在Hacking方法中，万万不能尝试那些无聊的程序。
你选择的程序没有必要非得很严肃。许多人会通过改进他们喜欢的游戏来磨砺编程技能。这么做，美中不足是，现代游戏通常相当庞大和复杂，可能超出了一个初学者的掌控能力。不过你可以尝试些经典的文本游戏，其中nethack绝对是首选。

2. 如果你还不了解这个程序，那就学会如何使用它。去读读文档。在脑子里建立它的原理模型，弄明白它大概是怎么运行的。

3. 找一个小的功能，尝试改动或者添加进去。

4. 搜索代码中你需要修改的地方。
注意：你不该尝试读下来整个代码。如果你这么做，你会感到疲惫和困惑。相反，你应该利用代码的模块化设计，将精力集中在你想要弄懂的部分。这么下去，你终将弄懂整个程序模块间如何彼此配合。
为你所读的代码添加解释性注释会是个不错的练习。这将会帮助你记忆和组织你对于该程序的想法。

5. 编码，测试，调试，然后将你的修改写进文档。
将修改的部分整理进文档非常重要。如果你早早地这么做了，你将会创造出上乘的杰作。

6. 把你修改的工作发给程序的维护者。关于如何有效和礼貌地做这个，可以看看这篇文章里的忠告：[Software Release Practice HOWTO](http://www.tldp.org/HOWTO/Software-Release-Practice-HOWTO/index.html)。
我原本把这项列为可选项，但一个聪明的朋友指出我不该这么做。自顾自埋头钻研乐器可能不错，但是只有在被他人聆听后，音乐的创造特质才算真正地体现出来。同样，埋头钻研你的电脑也很棒，但是当人们使用了你的代码，并由此改变了世界，Hacking才变得更有意义。现实世界的反应很重要。
有时候（尤其是你开始提交PR的代码时）你的代码会被拒绝。你需要学会面对这些。这并不意味着你注定失败，通常只是说明你还没足够仔细地阅读你要Hacking的程序，或者你忽视了某些该程序维护社区的文化。不过，这些问题总归可以弥补。

7. 现在，问问自己：我是否弄懂了整个程序？
如果懂了，Hacking成功。如果不懂，请移步第3项。这一次，挑一个不同的、稍稍难一点的功能去Hacking。

渐进式循环hacking法的关键是一步一步弄懂整个程序，而不是一上来就试图解决所有复杂的问题。随着你循环几次地做下来，你将在头脑里拥有一个关于这个程序各功能模块运行的完整描述。最终，你将弄懂一个复杂的程序，或者达到足够完成你手头的工作的程度。

## 培养设计直觉

拿小程序开始练习。如果可能的话，首先在10～50行的小程序或脚本上练习渐进式Hacking编程套路。或许这种代码很难找，网上许多符合这类要求的程序通常会是shell脚本或Perl、Python、Tcl程序。

当你在小程序上应用了几次渐进式Hacking法之后（或者，你没能找到适合的小程序），试着在稍大些的程序上继续这种Hacking法。这回，寻找那些100～500行的程序。

掌握了上述规模之后，接着来1000～5000行的程序。在你完全对付得来1K～5K规模的时候，你已经达到熟练程度了。

达到1K～5K程度以及之前，你可能开始发觉有种修改程序结构组织的冲动，而不仅仅是修改某项功能。你或许抱怨“这程序写得真够烂的”，你很想让它漂亮点、简洁点。

当这种情况发生时，要注意了。你软件设计直觉正在一点点被唤醒。不要急于着手修改下一个功能。相反，你要开始审视程序。现在或许是你尝试阅读整个代码的最佳时机，不过，如果你还不能读懂全部代码也不用太担心。大多数程序太臃肿，以至于无法一下就理解全部代码。只要试着弄懂你想重写的部分就好了。

其实，你正在处于学习hack的过渡阶段。这个阶段中不但修改可见功能代码，而且还有“重构”过程。“重构”就意味着从内部调整代码，使其更简洁、拥有更棒的架构（更好地隐藏数据、模块间更紧凑的交互接口、模块间更清楚的功能划分等等）。

一旦你的设计直觉（类似你对音乐敏感的耳朵）被激活，你会发现你将很快开始着手重构你手头的程序。

事实上，这正是那些成熟黑客把握程序代码的方式——通过修改、重构、甚至重写，直到他们自我认同为止。起初不起眼的修动是为了更复杂的改动。

如果你成功重构了三到四个大的软件系统，那么你不仅仅获得了过硬的编程本领，而且正在通往一条人迹罕至又神圣有力的道路：成为一名软件架构师。你将可以独立创造软件系统了。

新手架构师如何培养设计直觉，这是我唯一知道的方法。或许的确也是不二法门。


## 自成一体

在前面学音乐的类比，我说过你最终需要学会，组合音乐构型（pattern）于你自己的作品中（通过你不断的聆听和演奏）。我选择这种方式，描述创造性活动，这种方式对于软件设计，甚至比音乐创作为适用。

在你阅读和吸收大量代码之前，你脑子里或许还没有一个“模式库”，而它对于构建大型软件非常必要。渐进式Hacking编程套路，其中一个目的，就是让自己沉浸在大量代码中，并且让复杂程度逐渐增加。这样，你就有不断阅读代码的动力。

最终，你将领导项目组，完全的自主创作。千万别急于求成或者强己所难；如果你能给自己的技术充分时间去成熟，那么你的第一件作品将会更完美。积极投身开源项目，你将会学到不少（包括交流技巧）用以自己的项目中来。

## 备注

本文翻译，是在 http://ch4n7.github.io/blog/hacking-cycle/ 的基础上，进行校对，删减与文辞润色。
欢迎 PR 进一步修改。